# myapp9 Infrastructure

Azure infrastructure for myapp9

## Prerequisites

### Required Tools
- [Azure CLI](https://docs.microsoft.com/cli/azure/install-azure-cli) (v2.50+)
- [Azure Developer CLI (azd)](https://learn.microsoft.com/azure/developer/azure-developer-cli/install-azd) (v1.5+)
- [Git](https://git-scm.com/downloads)
- [GitHub CLI](https://cli.github.com/) (optional but recommended)

### Azure Requirements
- Azure subscription with Owner or Contributor access
- Permissions to create Service Principals (or existing Service Principal)

## Quick Start

1. Clone this repository
2. Set up Azure authentication (see Authentication Setup below)
3. Configure GitHub secrets (see GitHub Setup below)
4. Deploy infrastructure using GitHub Actions or azd CLI

## Project Structure

    .
    |-- .github/
    |   |-- workflows/              # GitHub Actions workflows
    |   |-- ISSUE_TEMPLATE/         # Issue templates for infrastructure requests
    |   |-- copilot-instructions.md # Context for GitHub Copilot
    |-- infra/
    |   |-- main.bicep              # Main infrastructure template
    |   |-- main.parameters.json    # Default parameters
    |   |-- modules/                # Bicep modules
    |-- environments/               # Environment-specific configurations
    |   |-- development/
    |   |-- staging/
    |   |-- production/
    |-- scripts/                    # Utility scripts
    |-- docs/                       # Additional documentation
    |-- azure.yaml                  # Azure Developer CLI configuration

## Authentication Setup

### Option 1: Create Service Principal (Recommended for CI/CD)

Login to Azure:

    az login

Set your subscription:

    az account set --subscription "YOUR-SUBSCRIPTION-NAME-OR-ID"

Create Service Principal:

    az ad sp create-for-rbac \
        --name "sp-myapp9-github" \
        --role contributor \
        --scopes /subscriptions/$(az account show --query id -o tsv) \
        --sdk-auth

Save the output - you'll need it for GitHub Secrets.

### Option 2: Use Azure Developer CLI (For local development)

Login with azd:

    azd auth login

Initialize environment:

    azd env new development

## GitHub Setup

### Required Secrets

Go to Settings > Secrets and variables > Actions and add:

| Secret Name | Description | How to Get |
|------------|-------------|------------|
| AZURE_CLIENT_ID | Service Principal Application ID | From SP creation output |
| AZURE_TENANT_ID | Azure AD Tenant ID | From SP creation output |
| AZURE_SUBSCRIPTION_ID | Azure Subscription ID | Run: az account show --query id -o tsv |

### Optional Secrets

| Secret Name | Description | When Needed |
|------------|-------------|-------------|
| AZURE_CLIENT_SECRET | Service Principal Secret | If using SP authentication |
| INFRACOST_API_KEY | Infracost API key | For cost estimation |

## Creating Infrastructure

### Using GitHub Issues

1. Go to Issues > New issue
2. Select an infrastructure template
3. Fill in the requirements
4. Assign to team member or Copilot Workspace
5. Implementation gets created as PR

### Using Azure Developer CLI

Deploy to development:

    azd up --environment development

Deploy to production:

    azd up --environment production

## Documentation

- [Infrastructure Components](docs/infrastructure.md)
- [Deployment Guide](docs/deployment.md)
- [Troubleshooting](docs/troubleshooting.md)

## Contributing

See [CONTRIBUTING.md](CONTRIBUTING.md) for guidelines.

---
Generated by create-azure-project.ps1 on 2025-08-01